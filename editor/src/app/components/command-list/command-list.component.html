<ng-container *ngIf="extensions$ | async as extensions; else loading">
  <ng-container *ngFor="let extension of extensions">
    <ng-container *ngIf="isExtensionChecked(extension.name) | async">
      <div class="command-list">
        <div
          class="row mb-3"
          *ngFor="
            let command of extension.commands
              | attrFilter
                : (selectedFiltersOnly$ | async)
                : (selectedFiltersExcept$ | async)
              | fusejs: (searchTerm$ | async):searchOptions
          "
        >
          <div class="col-12">
            <div class="card">
              <div class="card-body">
                <a
                  *ngIf="config.features.editing"
                  class="btn edit-button small text-muted"
                  href="#"
                  (click)="edit(command, extension.name)"
                  >Edit</a
                >
                <a
                  *ngIf="!config.features.editing"
                  class="btn edit-button small text-muted"
                  (click)="displayInfo(command, extension.name)"
                  [routerLink]="['/', game, extension.name, command.id]"
                  [replaceUrl]="true"
                  [name]="command.id"
                  >Info</a
                >
                <div class="row">
                  <div class="col-md-2">
                    <a
                      (click)="displayInfo(command, extension.name)"
                      [routerLink]="['/', game, extension.name, command.id]"
                      [replaceUrl]="true"
                      [name]="command.id"
                      [innerHTML]="command[searchOptions.fusejsHighlightKey].id"
                      >{{ command.id }}</a
                    >
                  </div>

                  <div
                    class="col-md-8"
                    [innerHTML]="command[searchOptions.fusejsHighlightKey].name"
                  >
                    {{ command.name }}
                  </div>
                </div>

                <div class="row">
                  <div class="col-12">
                    <div
                      class="my-2"
                      *ngIf="
                        !command.attrs.is_unsupported && !command.attrs.is_nop
                      "
                      [innerHTML]="
                        command[searchOptions.fusejsHighlightKey].short_desc
                      "
                    >
                      {{ command.short_desc }}
                    </div>
                    <ng-container *ngIf="command.attrs.is_unsupported"
                      >Unsupported</ng-container
                    >
                    <ng-container *ngIf="command.attrs.is_nop"
                      >Does nothing (NOP)</ng-container
                    >
                  </div>
                </div>

                <div class="row" *ngIf="command.attrs.is_keyword">
                  <div class="col-12">
                    <code>{{ command.name | lowercase }}</code>
                  </div>
                </div>

                <div class="row" *ngIf="command.class && command.member">
                  <div class="col-12">
                    <code
                      ><span
                        [innerHTML]="
                          command[searchOptions.fusejsHighlightKey].class
                        "
                        >{{ command.class }}</span
                      >.<span
                        [innerHTML]="
                          command[searchOptions.fusejsHighlightKey].member
                        "
                        >{{ command.member }}</span
                      >{{ command | params }}</code
                    >
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </ng-container>
  </ng-container>
</ng-container>

<ng-template #loading>
  <div
    class="spinner-border text-info"
    role="status"
    *ngIf="loading$ | async"
  ></div>
</ng-template>
